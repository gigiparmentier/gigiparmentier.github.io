<!DOCTYPE HTML>
<html>

<head>
  <title>Attestation</title>
  <meta charset="utf-8">
  <style>
    html{
      font-size: 20px;
      font-family: Helvetica;
    }
    input, button, select{
      display: inline-block;
      width:250px;
      height:40px;
      margin:10px;
    }
    #div{
      text-align: center;
      display: block;
      margin:0 auto;
    }
    canvas{
      display: block;
      margin:0 auto;
    }
  </style>
</head>

<body>
  <div id="div">
    <input id="nom" type="text" placeholder="Nom"><br/>
    <input id="date" type="text" placeholder="Date de naissance"><br/>
    <input id="domicile" type="text" placeholder="Domicile"><br/>
    <input id="ville" type="text" placeholder="Ville"><br/>
    <label for="raison">Raison :</label><br/>
    <select id="raison" onchange="remplir()">
      <option value="professionnelle">Professionnelle</option>
      <option value="courses">Courses</option>
      <option value="sante">Santé</option>
      <option value="famille">Familiale</option>
      <option value="sport">Activité sportive</option>
    </select><br/>
    <button onclick="remplir()">Valider</button><br/>
    <button onclick="download()">Téléchager</button>
  </div>
  <canvas id="canvas" onclick="download()"></canvas>
  <script>
    function remplir() {
      var canvas = document.getElementById("canvas"),
      ctx = canvas.getContext("2d");

      canvas.width = 1241;
      canvas.height = 1754;
      ctx.font = "20px Arial";

      var background = new Image();
      background.src = "bg.jpg";

      background.onload = function() {
        ctx.drawImage(background, 0, 0);
        var today = new Date();
        var dd = String(today.getDate()).padStart(2, '0');
        var mm = String(today.getMonth() + 1).padStart(2, '0');

        today = dd + '    ' + mm;

        ctx.fillText(today, 1000, 1460);

        ville = document.getElementById("ville").value;
        ctx.fillText(ville, 800, 1460);
        nom = document.getElementById("nom").value;
        ctx.fillText(nom, 270, 460);
        date = document.getElementById("date").value;
        ctx.fillText(date, 270, 520);
        domicile = document.getElementById("domicile").value;
        ctx.fillText(domicile, 270, 585);

        var tick = new Image();
        tick.src = "tick.png";
        y = 0

        tick.onload = function() {
          switch (document.getElementById("raison").value){
            case 'professionnelle':
              y = 830
              break
            case 'courses':
              y = 985
              break
            case 'sante':
              y = 1085
              break
            case 'famille':
              y = 1145
              break
            case 'sport':
              y = 1240
              break
            default:
              console.log('Sorry, we are out of .' + document.getElementById("raison").value);
          }
          ctx.drawImage(tick, 100, y);
        }
      }


    }
    function download(){
      var canvas = document.getElementById("canvas");
      var img = canvas.toDataURL("image/png");
      document.write('<img src="'+img+'"/>');
    }
  </script>
</body>

</html>
